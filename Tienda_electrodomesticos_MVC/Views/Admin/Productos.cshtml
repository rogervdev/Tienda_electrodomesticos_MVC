@model List<Tienda_electrodomesticos_MVC.Models.Producto>
@inject IConfiguration Configuration
@{
    var api = Configuration["ApiBaseUrl"];
}
@{
    ViewData["Title"] = "Productos";
}

<section>
    <div class="container-fluid px-5">
        <div class="card shadow-sm rounded-4 m-5">
            <!-- Header -->
            <div class="card-header bg-primary text-white text-center py-3 rounded-top">
                <h4 class="mb-0">Listado de Productos</h4>
            </div>

            <!-- Body -->
            <div class="card-body p-3">
                <!-- Botón regresar a admin -->
                <div class="mb-3">
                    <a asp-controller="Admin" asp-action="Index" class="btn btn-secondary">
                        <i class="fa-solid fa-arrow-left me-2"></i> Regresar al Panel
                    </a>
                </div>

                <!-- Tabla de productos -->
                <div class="table-responsive">
                    <table class="table table-bordered table-striped align-middle mb-0">
                        <thead class="table-light text-center">
                            <tr>
                                <th>#</th>
                                <th>Imagen</th>
                                <th>Título</th>
                                <th>Descripción</th>
                                <th>Categoría</th>
                                <th>Precio</th>
                                <th>Descuento</th>
                                <th>Precio con Descuento</th>
                                <th>Estado</th>
                                <th>Stock</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int i = 0; i < Model.Count; i++)
                            {
                                var p = Model[i];
                                <tr>
                                    <td class="text-center">@(@i + 1)</td>
                                    <td class="text-center">
                                        <img src="@($"{api}/images/productos/{p.Imagen}")" class="rounded-circle border" style="width:50px;height:50px;object-fit:cover" />

                                    </td>
                                    <td class="text-center">@p.Titulo</td>
                                    <td class="text-center">@p.Descripcion</td>
                                    <td class="text-center">@p.CategoriaNombre</td>
                                    <td class="text-end">S/ @p.Precio</td>
                                    <td class="text-end">@p.Descuento %</td>
                                    <td class="text-end">@p.PrecioConDescuento.GetValueOrDefault().ToString("C2")</td>
                                    <td class="text-center">
                                        <span class="badge @(p.IsActive ? "bg-success" : "bg-danger")">
                                            @(p.IsActive ? "Activo" : "Inactivo")
                                        </span>
                                    </td>
                                    <td class="text-center">@p.Stock</td>
                                    <td class="text-center">
                                        <div class="d-flex justify-content-center gap-2">
                                            <!-- Editar Producto -->
                                            <a asp-controller="Admin" asp-action="EditarProducto" asp-route-id="@p.Id"
                                               class="btn btn-sm btn-info d-flex align-items-center" title="Editar producto">
                                                <i class="fa-solid fa-pen me-1"></i>Editar
                                            </a>

                                            <!-- Eliminar Producto -->
                                            <form asp-controller="Admin" asp-action="EliminarProducto" asp-route-id="@p.Id" method="post"
                                                  onsubmit="return confirm('¿Seguro que deseas eliminar este producto?');">
                                                <button type="submit" class="btn btn-sm btn-danger d-flex align-items-center" title="Eliminar producto">
                                                    <i class="fa-solid fa-trash me-1"></i>Eliminar
                                                </button>
                                            </form>

                                            <!-- Agregar Producto -->
                                            <a asp-controller="Admin" asp-action="AgregarProducto" class="btn btn-sm btn-success d-flex align-items-center"
                                               title="Agregar Producto">
                                                <i class="fa-solid fa-plus me-1"></i>Agregar
                                            </a>
                                        </div>

                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
